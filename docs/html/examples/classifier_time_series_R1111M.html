

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>&lt;no title&gt; &mdash; PTSA 1.1.4 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PTSA 1.1.4 documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PTSA
          

          
          </a>

          
            
            
              <div class="version">
                1.1.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">PTSA Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ramdata.html">Interacting with RAM Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filters.html">Filtering Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development guidelines</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PTSA</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>&lt;no title&gt;</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/classifier_time_series_R1111M.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [71]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>import sys

# sys.path.append(&#39;/Users/m/PTSA_NEW_GIT/&#39;)
import numpy as np
from numpy.testing import *
from ptsa.data.readers import BaseEventReader
from ptsa.data.filters.MorletWaveletFilter import MorletWaveletFilter
from ptsa.data.readers.TalReader import TalReader
from ptsa.data.readers import EEGReader
from ptsa.data.filters import MonopolarToBipolarMapper
from ptsa.data.filters import DataChopper
from ptsa.data.common import xr
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import roc_auc_score, roc_curve
from scipy.stats.mstats import zscore
import numpy.testing as npt
import cPickle
import os
from collections import namedtuple
from time import time
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [72]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>%matplotlib inline

import matplotlib
import numpy as np
import matplotlib.pyplot as plt
</pre></div>
</div>
</div>
<p>When runing first time set compute_classifier_flag to True. Subsequent
runc can be executed with flag set to False because classifier will be
computed and stored on the hard drive at that time</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [73]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>subject = &#39;R1111M&#39;
e_path = os.path.join(&#39;/Users/m/data/events/RAM_FR1/&#39;,subject+&#39;_events.mat&#39;)

tal_path = os.path.join(&#39;/Users/m/data/eeg&#39;,subject,&#39;tal&#39;,subject+&#39;_talLocs_database_bipol.mat&#39;)

ClassifierData = namedtuple(&#39;ClassifierData&#39;, [&#39;lr_classifier&#39;, &#39;mean&#39;,&#39;std&#39;])

compute_classifier_flag = False
</pre></div>
</div>
</div>
<p>reading electrodes information</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [74]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def get_monopolar_and_bipolar_electrodes():
    tal_reader = TalReader(filename=tal_path)
    monopolar_channels = tal_reader.get_monopolar_channels()
    bipolar_pairs = tal_reader.get_bipolar_pairs()
    return monopolar_channels, bipolar_pairs
</pre></div>
</div>
</div>
<p>reading events</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [75]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def get_events():
    # ---------------- NEW STYLE PTSA -------------------
    base_e_reader = BaseEventReader(filename=e_path, eliminate_events_with_no_eeg=True)

    base_events = base_e_reader.read()

    base_events = base_events[base_events.type == &#39;WORD&#39;]
    return base_events
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [76]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def get_bp_data(base_events):
    # retaining first session
    sessions = np.unique(base_events.session)
    # dataroot = base_events[0].eegfile
    # base_events = base_events[base_events.eegfile == dataroot]

    eeg_reader = EEGReader(events=base_events, channels=monopolar_channels,
                           start_time=0.0, end_time=1.6, buffer_time=1.0)

    base_eegs = eeg_reader.read()

    m2b = MonopolarToBipolarMapper(time_series=base_eegs, bipolar_pairs=bipolar_pairs)
    bp_eegs = m2b.filter()
    return bp_eegs
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [77]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def compute_wavelets(base_events):
    from time import time
    s = time()

    bp_eegs = get_bp_data(base_events)
    wf = MorletWaveletFilter(time_series=bp_eegs,
                             freqs=np.logspace(np.log10(3), np.log10(180), 8),
                             output=&#39;power&#39;,
                             frequency_dim_pos=0,
                             verbose=True
                             )
    pow_wavelet, phase_wavelet = wf.filter()
    print &#39;TOTAL WAVELET TIME=&#39;, time() - s
    return pow_wavelet
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [78]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def prepare_classifier_data(zscore_mean_powers,evs,sess_min,sess_max):
    session_mask = (evs.session &gt;= sess_min) &amp; (evs.session &lt;= sess_max)
    evs_sel = evs[session_mask]
    recalls = evs_sel.recalled.astype(np.int)
    features = zscore_mean_powers[session_mask, ...]

    return features, recalls
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [79]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def train_classifier(features, recalls):

    lr_classifier = LogisticRegression(C=7.2e-4, penalty=&#39;l2&#39;, class_weight=&#39;auto&#39;, solver=&#39;liblinear&#39;)
    lr_classifier.fit(features, recalls)
    return lr_classifier
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [80]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def compute_continuous_wavelets(session=0):
    dataroot = base_events[base_events.session==session][0].eegfile
    session_reader = EEGReader(session_dataroot=dataroot, channels=monopolar_channels)
    session_eegs = session_reader.read()

    m2b = MonopolarToBipolarMapper(time_series=session_eegs, bipolar_pairs=bipolar_pairs)
    session_bp_eegs = m2b.filter()

    wf = MorletWaveletFilter(time_series=session_bp_eegs,
                         freqs=np.logspace(np.log10(3), np.log10(180), 8),
                         output=&#39;power&#39;,
                         frequency_dim_pos=0,
                         verbose=True
                         )

    pow_wavelet_session, phase_wavelet_session = wf.filter()
    return pow_wavelet_session
</pre></div>
</div>
</div>
<p>This function chops continuous time series into chunks corresponding to
events where events can in fact be specified using simple array of
offsets. Offsets then correspond to positions at which time series will
be cut - note that you may cut eeg series but also time series of
wavelets cooeficients</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [81]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def chop_time_series(time_series,start_offsets):
    dc = DataChopper(start_offsets=start_offsets, session_data=time_series, start_time=0.0, end_time=1.6)
    chopped_time_series = dc.filter()
    return chopped_time_series
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [82]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def compute_classifier_features(pow_wavelet):
    np.log10(pow_wavelet.data, out=pow_wavelet.data);

    pow_wavelet = pow_wavelet.transpose(&#39;events&#39;, &quot;bipolar_pairs&quot;, &quot;frequency&quot;, &quot;time&quot;)

    mean_powers_nd = np.nanmean(pow_wavelet.data, axis=-1)

    mean_powers_rs = mean_powers_nd.reshape(mean_powers_nd.shape[0], -1)
    mean_powers_rs.shape

    zscore_mean_powers = zscore(mean_powers_rs, axis=0, ddof=1)

    return zscore_mean_powers
</pre></div>
</div>
</div>
<p>This function computes zscoring params - instead of using zscore
function we will use more pedestrian way of zscoring</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [83]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def compute_zscoring_params(log_pow_wavelet):
    transposed_log_pow_wavelet = log_pow_wavelet.transpose(&#39;events&#39;, &quot;bipolar_pairs&quot;, &quot;frequency&quot;, &quot;time&quot;)
    mean_powers_nd = np.nanmean(transposed_log_pow_wavelet.data, axis=-1)
    mean_powers_rs = mean_powers_nd.reshape(mean_powers_nd.shape[0], -1)
    m = np.mean(mean_powers_rs,axis=0)
#     print m[:3]
    s = np.std(mean_powers_rs,axis=0,ddof=1)

    zscore_mean_powers = zscore(mean_powers_rs, axis=0, ddof=1)

    z_score = (mean_powers_rs-m)/s
    npt.assert_array_equal(zscore_mean_powers,z_score)
    return m,s
</pre></div>
</div>
</div>
<p>this function zscores features using mean and std dev returned by
compute_zscoring_params</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [84]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def compute_features_using_zscoring_params(pow_wavelet,mean,std):
    log_pow_wavelet = np.log10(pow_wavelet.data);

    transposed_log_pow_wavelet = pow_wavelet.transpose(&#39;events&#39;, &quot;bipolar_pairs&quot;, &quot;frequency&quot;, &quot;time&quot;)

    mean_powers_nd = np.nanmean(transposed_log_pow_wavelet.data, axis=-1)

    mean_powers_rs = mean_powers_nd.reshape(mean_powers_nd.shape[0], -1)
    mean_powers_rs.shape

    z_score_mean_powers = (mean_powers_rs-mean)/std

    return z_score_mean_powers
</pre></div>
</div>
</div>
<p>this is just a test function not used in “production code”</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [85]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def test_zscoring_computations():
    s=time()
    pow_wavelet = compute_wavelets(base_events)
    print &#39;TIME: EEG READING + WAVELETS=&#39;,time()-s
    zscore_mean_powers = compute_classifier_features(pow_wavelet)
    mean,std = compute_zscoring_params(log_pow_wavelet=pow_wavelet)
    transposed_log_pow_wavelet =pow_wavelet.transpose(&#39;events&#39;, &quot;bipolar_pairs&quot;, &quot;frequency&quot;, &quot;time&quot;)
    mean_powers_nd = np.nanmean(transposed_log_pow_wavelet.data, axis=-1)
    mean_powers_rs = mean_powers_nd.reshape(mean_powers_nd.shape[0], -1)
    print zscore_mean_powers - (mean_powers_rs-mean)/std
    zscore_mean_powers_alt = compute_features_using_zscoring_params(pow_wavelet,mean,std)
    zscore_mean_powers_alt-zscore_mean_powers
</pre></div>
</div>
</div>
<p>This function computes classifier</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [86]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def compute_classifier():
    s=time()
    pow_wavelet = compute_wavelets(base_events)
    print &#39;TIME: EEG READING + WAVELETS=&#39;,time()-s
    pow_wavelet = pow_wavelet.remove_buffer(duration=1.0)

    np.log10(pow_wavelet.data, out=pow_wavelet.data);
    log_pow_wavelet = pow_wavelet
    mean,std = compute_zscoring_params(log_pow_wavelet=log_pow_wavelet)
    zscore_mean_powers = compute_features_using_zscoring_params(log_pow_wavelet,mean,std)

#     zscore_mean_powers = compute_classifier_features(pow_wavelet)
    training_features, training_recalls  = prepare_classifier_data(zscore_mean_powers, base_events,sess_min=0,sess_max=1)
    lr_classifier = train_classifier(training_features,training_recalls)

    validation_features, validation_recalls  = prepare_classifier_data(zscore_mean_powers, base_events,sess_min=2,sess_max=2)

    recall_prob_array = lr_classifier.predict_proba(training_features)[:, 1]
    auc = roc_auc_score(training_recalls, recall_prob_array)
    print &#39;auc=&#39;, auc

    validation_recall_prob_array = lr_classifier.predict_proba(validation_features)[:, 1]
    auc = roc_auc_score(validation_recalls, validation_recall_prob_array)
    print &#39;auc=&#39;, auc
    classifier_data = ClassifierData(lr_classifier=lr_classifier,mean=mean,std=std)

    # save the classifier
    with open(&#39;classifier_data_&#39;+subject+&#39;.pkl&#39;, &#39;wb&#39;) as fid:
        cPickle.dump(classifier_data, fid)
</pre></div>
</div>
</div>
<p>This function will tak as an input the following: 1. wavelets computed
for the entire session 2. ClassifierData tuple - containing trained
classifier, mean and std dev for z scoring 3. start_time (in seconds) -
determines the time location of the epoch at which we being computting
probs tgime series 4. end_time (in seconds) - determines the last epoch
of thr probs time series 5. resolution - separation of the time points
(in seconds) at which we calculate recall probabilities 5. slice_size -
determines the number of choping operations DataChopper performs - since
Data Chopper returns eeg time series using smaller slice_size has less
strain on memory. in principle call Data Chopper only once but if the
number of chops is large we might run out of memory…</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [87]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>def compute_probs_ts(pow_wavelet_session,classifier_data,start_time = 10.0, end_time=20.0, slice_size=10, resolution=0.1):

    lr_classifier = classifier_data.lr_classifier
    mean = classifier_data.mean
    std = classifier_data.std

    #resolution is in seconds
    samplerate = float(pow_wavelet_session[&#39;samplerate&#39;])

    number_of_samples_in_resolution = int(round(resolution*samplerate))

    total_number_of_items  = int(round((end_time-start_time)/resolution))

    number_of_compute_iterations = total_number_of_items / slice_size

    probs_list=[]


    for n in xrange(number_of_compute_iterations):
        st = start_time + n*slice_size*resolution
        initial_offset = int(round(st*samplerate))
        start_offsets = initial_offset +  np.arange(slice_size)*number_of_samples_in_resolution

        pow_wavelet_chopped = chop_time_series(time_series=pow_wavelet_session,start_offsets=start_offsets)
        pow_wavelet_chopped = pow_wavelet_chopped.rename({&#39;start_offsets&#39;:&#39;events&#39;})
        np.log10(pow_wavelet_chopped.data, out=pow_wavelet_chopped.data)

        features = compute_features_using_zscoring_params(pow_wavelet_chopped,mean,std)
        probs = lr_classifier.predict_proba(features)[:, 1]

        probs_list.append(probs)


    probs_array = np.hstack(probs_list)
    time_axis = start_time + np.arange(probs_array.shape[0])*resolution
    return time_axis, probs_array
</pre></div>
</div>
</div>
<p>Begining of the computational pipeline that computes classifiers</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [88]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>base_events = get_events()
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [89]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>monopolar_channels, bipolar_pairs = get_monopolar_and_bipolar_electrodes()
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>if compute_classifier_flag:
    compute_classifier()

#we read classifier from the disk

with open(&#39;classifier_data_&#39;+subject+&#39;.pkl&#39;, &#39;rb&#39;) as fid:
    classifier_data = cPickle.load(fid)

lr_classifier = classifier_data.lr_classifier
mean = classifier_data.mean
std = classifier_data.std
</pre></div>
</div>
</div>
<p>Computing wavelets for entire session (continuous mode)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>pow_wavelet_session = compute_continuous_wavelets(session=0)
</pre></div>
</div>
</div>
<p>Here we are computing time series of recall probabilities</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>time_axis, probs_array = compute_probs_ts(pow_wavelet_session,
                                          classifier_data,
                                          start_time=50.0,
                                          end_time=70.0,
                                          slice_size=10,
                                          resolution=0.1
                                          )
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>plt.plot(time_axis,probs_array)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython2"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.1.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>